# 通信模型C++项目开发约束文档

## 一、项目概述

本项目是一个基于C++的通信系统仿真模型，旨在构建完整的通信抗干扰方案。项目包含信号传输模型、通信距离模型、通信接收模型、通信干扰模型和通信抗干扰模型等核心模块。

### 1.1 项目目标
- 实现多种通信模型的C++仿真
- 提供完整的抗干扰解决方案
- 支持多种调制方式和干扰类型
- 提供准确的性能评估指标

### 1.2 项目范围
- 支持短波、超短波、微波三个频段
- 支持AM、FM、BPSK、QPSK、16QAM调制方式
- 支持高斯白噪声、窄带干扰、扫频干扰、脉冲干扰
- 支持FHSS、DSSS、自适应滤波等抗干扰技术

## 二、目录结构约束

### 2.1 强制目录结构
```
d:\code\signal-transmission-model-cpp\
├── build\                          # 构建目录
│   ├── CMakeLists.txt             # CMake构建配置文件
│   ├── bin\                       # 可执行文件输出目录
│   ├── lib\                       # 库文件输出目录
│   └── obj\                       # 中间文件目录
├── docs\                           # 文档目录
│   ├── data\                      # 测试数据存储目录
│   ├── 基础通信能力模型参数设计.md
│   ├── 通信干扰模型.md
│   ├── 通信抗干扰模型.md
│   ├── 通信接收模型.md
│   └── 通信距离模型.md
├── scripts\                        # 脚本目录
├── source\                         # 源码目录
│   ├── header\                    # 头文件目录
│   └── src\                       # 源文件目录
├── test\                          # 测试目录
└── 开发约束文档.md                 # 本文档
```

### 2.2 目录使用规范
- **build/**: 构建相关文件和生成文件存储目录
  - 存放CMakeLists.txt主配置文件
  - bin/子目录存放生成的可执行文件
  - lib/子目录存放生成的库文件（.dll、.so、.lib等）
  - obj/子目录存放编译中间文件
  - 禁止将build目录内容提交到版本控制系统
- **docs/**: 存放所有技术文档和设计文档，禁止存放代码文件
- **docs/data/**: 专门存储测试数据，数据格式必须为JSON
- **scripts/**: 存放构建脚本、部署脚本和自动化工具脚本
- **source/header/**: 存放所有.h头文件，按模块分类命名
- **source/src/**: 存放所有.cpp源文件，与头文件一一对应
- **test/**: 存放所有测试用例代码和测试脚本

## 三、代码开发约束

### 3.1 编程语言和标准
- **语言**: C++11及以上标准
- **编译器**: 支持GCC 7.0+、MSVC 2017+、Clang 6.0+
- **字符编码**: UTF-8

### 3.2 命名规范
- **类名**: 使用PascalCase，如`CommunicationDistanceModel`
- **函数名**: 使用camelCase，如`calculateEffectiveDistance()`
- **变量名**: 使用camelCase，如`centerFrequency`
- **常量名**: 使用UPPER_SNAKE_CASE，如`MAX_FREQUENCY`
- **文件名**: 与主要类名保持一致，如`CommunicationDistanceModel.h`

### 3.3 代码结构约束
- 每个模型必须独立成类，避免模块间强耦合
- 所有类必须提供完整的getter/setter方法
- 参数设置方法必须包含合法性校验
- 必须提供参数信息输出方法`getParameterInfo()`
- 所有计算方法必须有明确的返回值和异常处理

### 3.4 头文件约束
- 使用include guard或#pragma once
- 头文件中只声明，不实现（内联函数除外）
- 必须包含完整的类和枚举声明
- 添加详细的注释说明
- **文件命名约束**: 头文件必须和对应的源文件同名（例如：`CommunicationDistanceModel.h` 对应 `CommunicationDistanceModel.cpp`）

### 3.5 跨平台通用头文件约束
- **强制要求**: 必须生成跨平台通用头文件以支持外部语言调用DLL
- **文件命名**: `CommunicationModelAPI.h`
- **存储位置**: `source/header/`目录
- **接口规范**:
  - 使用C风格接口函数，避免C++特性（如类、重载等）
  - 所有函数必须使用`extern "C"`声明
  - 参数类型使用基础数据类型（int、double、char*等）
  - 返回值统一使用错误码机制
- **平台兼容性**:
  - 支持Windows DLL导出（使用`__declspec(dllexport)`）
  - 支持Linux共享库导出（使用`__attribute__((visibility("default")))`）
  - 使用条件编译确保跨平台兼容
- **调用约定**:
  - Windows平台使用`__stdcall`调用约定
  - Linux平台使用默认调用约定
  - 提供统一的宏定义处理平台差异
- **数据传递**:
  - 复杂数据结构通过JSON字符串传递
  - 提供数据序列化和反序列化接口
  - 内存管理由DLL内部负责，提供释放接口
- **错误处理**:
  - 统一的错误码定义（0表示成功，负数表示错误）
  - 提供错误信息获取接口
  - 异常不能跨越DLL边界，必须转换为错误码

### 3.6 源文件约束
- 每个.cpp文件对应一个.h文件
- **文件命名约束**: 源文件必须和对应的头文件同名（例如：`CommunicationDistanceModel.cpp` 对应 `CommunicationDistanceModel.h`）
- 实现所有头文件中声明的方法
- 包含必要的输入验证和错误处理
- 添加详细的实现注释

## 四、测试约束

### 4.1 测试数据格式
- **强制格式**: JSON
- **存储位置**: `docs/data/`目录
- **命名规范**: `模块名_测试场景.json`
- **编码格式**: UTF-8

### 4.2 测试数据结构示例
```json
{
  "test_name": "通信距离模型基础测试",
  "test_cases": [
    {
      "case_id": "distance_001",
      "description": "开阔地环境通信距离测试",
      "input_parameters": {
        "maxLineOfSight": 10.0,
        "environmentType": "OPEN_FIELD",
        "envAttenuation": 1.0,
        "receiveSensitivity": -100.0,
        "linkMargin": 10.0,
        "transmitPower": 20.0
      },
      "expected_output": {
        "effectiveDistance": 8.5
      }
    }
  ]
}
```

### 4.3 测试用例约束
- 每个模型至少包含10个基础测试用例
- 必须覆盖边界值测试
- 必须包含异常输入测试
- 测试用例必须包含预期输出
- 测试结果误差容忍度不超过1%

### 4.4 测试文件约束
- 测试文件命名: `Test模块名.cpp`
- 必须包含JSON数据加载功能
- 必须提供测试结果输出
- 必须支持批量测试执行

## 五、模块开发约束

### 5.1 核心模块列表
1. **SignalTransmissionModel**: 信号传输模型
2. **CommunicationDistanceModel**: 通信距离模型
3. **CommunicationReceiveModel**: 通信接收模型
4. **CommunicationJammerModel**: 通信干扰模型
5. **CommunicationAntiJamModel**: 通信抗干扰模型

### 5.2 模块依赖约束
- 模块间依赖关系必须清晰明确
- 避免循环依赖
- 核心计算模块不依赖UI或IO模块
- 使用接口或抽象类定义模块间交互

### 5.3 参数范围约束
- **频率范围**: 1.5MHz - 30GHz
- **功率范围**: 0.1W - 100W
- **距离范围**: 0.1km - 50km
- **信噪比范围**: -20dB - 50dB
- **误码率范围**: 10^-8 - 10^-1

### 5.4 性能约束
- 单次计算时间不超过100ms
- 内存使用不超过100MB
- 支持并发计算
- 数值计算精度保持6位有效数字

## 六、文档约束

### 6.1 代码注释约束
- 所有公有方法必须有详细注释
- 复杂算法必须有实现思路说明
- 参数和返回值必须有类型和含义说明
- 使用Doxygen格式注释

### 6.2 技术文档约束
- 每个模型必须有对应的技术文档
- 文档必须包含理论基础、实现方法、使用示例
- 文档格式统一使用Markdown
- 数学公式使用LaTeX格式

### 6.3 API文档约束
- 自动生成API文档
- 包含完整的类图和调用关系
- 提供使用示例和最佳实践
- 定期更新维护

## 七、版本控制约束

### 7.1 分支管理
- **main分支**: 稳定发布版本
- **develop分支**: 开发集成分支
- **feature分支**: 功能开发分支
- **hotfix分支**: 紧急修复分支

### 7.2 提交规范
- 提交信息格式: `[模块名] 简要描述`
- 每次提交必须包含测试验证
- 禁止提交编译错误的代码
- 大型功能分多次小提交

### 7.3 代码审查
- 所有代码必须经过审查
- 审查重点: 算法正确性、代码规范、性能优化
- 审查通过后方可合并到主分支

### 7.4 版本控制忽略规则
- **必须提供.gitignore文件**，包含以下忽略规则:
  - `build/` - 整个构建目录
  - `*.obj`, `*.o` - 目标文件
  - `*.exe`, `*.dll`, `*.so` - 可执行文件和库文件
  - `*.lib`, `*.a` - 静态库文件
  - `*.pdb` - 调试信息文件
  - `.vs/`, `.vscode/` - IDE配置目录
  - `CMakeCache.txt`, `CMakeFiles/` - CMake生成文件

## 八、构建和部署约束

### 8.1 构建系统
- **CMake配置**:
  - 使用CMake作为构建系统
  - 主配置文件`CMakeLists.txt`必须存放在`build/`目录
  - 支持Debug和Release两种模式
  - 最低CMake版本要求3.10
- **构建目录约束**:
  - 所有生成文件必须输出到`build/`目录及其子目录
  - 可执行文件输出到`build/bin/`
  - 库文件输出到`build/lib/`
  - 中间文件输出到`build/obj/`
- **构建脚本**:
  - 提供自动化构建脚本存放在`scripts/`目录
  - 支持一键构建和清理
  - 支持跨平台编译（Windows/Linux）
- **输出约束**:
  - 禁止在源码目录生成任何构建文件
  - build目录内容不得提交到版本控制系统
  - 提供.gitignore忽略build目录

### 8.2 依赖管理
- 最小化外部依赖
- 优先使用C++标准库
- 第三方库必须开源且稳定
- 提供依赖安装脚本

### 8.3 部署要求
- 提供可执行文件和动态库
- **DLL生成要求**:
  - Windows平台生成.dll文件和对应的.lib导入库
  - Linux平台生成.so共享库文件
  - 必须包含跨平台通用头文件`CommunicationModelAPI.h`
  - 提供外部语言调用示例（Python、C#、Java等）
- 包含完整的使用说明
- 提供示例程序和测试数据
- 支持Windows和Linux平台

## 九、质量保证约束

### 9.1 代码质量
- 代码覆盖率不低于80%
- 静态代码分析无严重问题
- 内存泄漏检测通过
- 性能测试达标

### 9.2 算法验证
- 核心算法必须有理论验证
- 计算结果与理论值误差<1%
- 边界条件处理正确
- 异常情况处理完善

### 9.3 兼容性测试
- 支持主流编译器
- 支持不同操作系统
- 支持不同硬件平台
- 向后兼容性保证

## 十、维护和扩展约束

### 10.1 可维护性
- 代码结构清晰，易于理解
- 模块化设计，便于修改
- 完善的文档和注释
- 标准化的开发流程

### 10.2 可扩展性
- 支持新增调制方式
- 支持新增干扰类型
- 支持新增抗干扰算法
- 预留接口扩展点

### 10.3 长期维护
- 定期更新技术文档
- 持续优化算法性能
- 跟踪最新技术发展
- 社区反馈及时响应

---

**文档版本**: v1.2  
**创建日期**: 2024年12月  
**最后更新**: 2024年12月  
**维护人员**: 项目开发团队  
**v1.1更新内容**: 新增跨平台通用头文件约束，支持外部语言调用DLL  
**v1.2更新内容**: 完善build目录约束，详细规定CMake配置和构建输出规范，新增.gitignore规则  

**注意**: 本文档为项目开发的强制性约束，所有开发活动必须严格遵守。如需修改约束条件，必须经过项目组讨论并更新文档版本。